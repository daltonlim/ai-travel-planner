<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Travel Itinerary - AI Travel Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #fafafa;
            color: #1a1a1a;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        .header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 0.5rem;
        }

        .header .subtitle {
            font-size: 1.1rem;
            color: #6b7280;
            font-weight: 400;
        }

        .trip-overview {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #f3f4f6;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .overview-item {
            display: flex;
            flex-direction: column;
        }

        .overview-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .overview-value {
            font-size: 1.125rem;
            font-weight: 600;
            color: #1a1a1a;
        }

        .days-container {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .day-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #f3f4f6;
            transition: all 0.2s ease;
        }

        .day-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transform: translateY(-1px);
        }

        .day-header {
            background: #4f46e5;
            color: white;
            padding: 1.25rem 1.5rem;
            font-weight: 600;
            font-size: 1.125rem;
        }

        .day-header.work-day {
            background: #f59e0b;
        }

        .day-content {
            padding: 1.5rem;
        }

        .activity {
            margin-bottom: 1.25rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid #f3f4f6;
        }

        .activity:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .activity-time {
            font-size: 0.875rem;
            font-weight: 600;
            color: #4f46e5;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .activity-title {
            font-size: 1rem;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 0.5rem;
        }

        .activity-description {
            color: #6b7280;
            font-size: 0.95rem;
        }

        .price {
            display: inline-block;
            background: #ecfdf5;
            color: #059669;
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            margin-left: 0.5rem;
        }

        .section-divider {
            background: #f3f4f6;
            height: 1px;
            margin: 3rem 0;
            border: none;
        }

        .budget-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #f3f4f6;
        }

        .budget-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 1.5rem;
        }

        .budget-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .budget-item {
            background: #f8fafc;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #4f46e5;
        }

        .budget-category {
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            margin-bottom: 0.25rem;
        }

        .budget-amount {
            font-size: 1.25rem;
            font-weight: 700;
            color: #1a1a1a;
        }

        .tips-section {
            background: #fef3c7;
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 2rem;
            border-left: 4px solid #f59e0b;
        }

        .tips-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: #92400e;
            margin-bottom: 1rem;
        }

        .tips-list {
            list-style: none;
            color: #92400e;
        }

        .tips-list li {
            margin-bottom: 0.5rem;
            position: relative;
            padding-left: 1.5rem;
        }

        .tips-list li::before {
            content: "ðŸ’¡";
            position: absolute;
            left: 0;
        }

        .export-button {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
            text-decoration: none;
        }

        .export-button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(5, 150, 105, 0.3);
        }

        .export-button svg {
            width: 18px;
            height: 18px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header h1 {
                font-size: 2rem;
            }

            .overview-grid {
                grid-template-columns: 1fr;
            }

            .budget-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Your Bali Adventure</h1>
            <p class="subtitle">2-week travel itinerary Â· July 17-30, 2025</p>
            <button class="export-button" onclick="exportToCalendar()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25m3 8.25v-8.25a2.25 2.25 0 00-2.25-2.25H5.25A2.25 2.25 0 003 5.25v8.25m18 0A2.25 2.25 0 0119.5 21h-12A2.25 2.25 0 015.25 21m13.5 0v-8.25" />
                </svg>
                Export to Calendar
            </button>
        </header>

        <section class="trip-overview">
            <div class="overview-grid">
                <div class="overview-item">
                    <span class="overview-label">Destination</span>
                    <span class="overview-value">Bali, Indonesia</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">Duration</span>
                    <span class="overview-value">14 Days</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">Budget</span>
                    <span class="overview-value">$1,000 USD</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">Group Size</span>
                    <span class="overview-value">Couple</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">Accommodation</span>
                    <span class="overview-value">Mid-range Hotels</span>
                </div>
                <div class="overview-item">
                    <span class="overview-label">Work Days</span>
                    <span class="overview-value">Jul 18, 21-24, 29-30</span>
                </div>
            </div>
        </section>

        <section class="days-container">
            <div class="day-card">
                <div class="day-header">Day 1: Arrival in Bali (July 17)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Arrive at Ngurah Rai International Airport</div>
                        <div class="activity-description">Welcome to Bali! Your adventure begins.</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Transfer to Ubud</div>
                        <div class="activity-description">Check into Alaya Ubud <span class="price">$80/night</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Explore Ubud Market</div>
                        <div class="activity-description">Dinner at Warung Babi Guling Ibu Oka <span class="price">$5</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 2: Ubud (July 18) - Work Day</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Work Session</div>
                        <div class="activity-description">Work from 6 AM to 12 PM - productive morning at the hotel</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Tegallalang Rice Terraces</div>
                        <div class="activity-description">Beautiful terraced landscapes perfect for photos <span class="price">$0.70</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Dinner at Naughty Nuri's</div>
                        <div class="activity-description">Famous for their ribs and lively atmosphere <span class="price">$10</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header">Day 3: Ubud (July 19)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Yoga at Radiantly Alive</div>
                        <div class="activity-description">Start your day with peaceful yoga practice <span class="price">$12</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Ubud Monkey Forest</div>
                        <div class="activity-description">Meet the local macaques in their natural habitat <span class="price">$5.50</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Fine dining at Locavore</div>
                        <div class="activity-description">Award-winning restaurant (book in advance!) <span class="price">$80</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header">Day 4: Ubud to Seminyak (July 20)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Check out & Transfer</div>
                        <div class="activity-description">Journey to Seminyak (1-hour drive)</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Check into The Haven Suites</div>
                        <div class="activity-description">Relax at Berawa Beach <span class="price">$95/night</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Sunset dinner at La Plancha</div>
                        <div class="activity-description">Beachfront dining with colorful bean bags</div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 5: Seminyak (July 21) - Work Day</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Work Session</div>
                        <div class="activity-description">Work from 6 AM to 12 PM with ocean breeze</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Petitenget Temple</div>
                        <div class="activity-description">Sacred Balinese temple by the sea <span class="price">$2</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Dinner at Bambu</div>
                        <div class="activity-description">Indonesian fine dining experience <span class="price">$20</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 6: Seminyak (July 22) - Work Day</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Work Session</div>
                        <div class="activity-description">Productive morning work session</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Kuta Beach Relaxation</div>
                        <div class="activity-description">Famous surf beach with golden sand</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Sea Circus Dinner</div>
                        <div class="activity-description">Trendy spot with great cocktails <span class="price">$10</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 7: Seminyak (July 23) - Work Day</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Work Session</div>
                        <div class="activity-description">Final morning work session in Seminyak</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Spa Day at Jari Menari</div>
                        <div class="activity-description">Couple's traditional Balinese massage <span class="price">$50</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Sisterfields Dinner</div>
                        <div class="activity-description">Popular cafe with healthy options <span class="price">$14</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 8: Seminyak to Nusa Penida (July 24) - Work Day</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Work Session</div>
                        <div class="activity-description">Early work before island adventure</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Fast Boat to Nusa Penida</div>
                        <div class="activity-description">Check into Semabu Hills Hotel <span class="price">$47 boat + $67/night</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Hotel Dinner</div>
                        <div class="activity-description">Relax after travel day</div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header">Day 9: Nusa Penida (July 25)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Kelingking Beach & Angel's Billabong</div>
                        <div class="activity-description">Iconic clifftop views and natural infinity pool <span class="price">$0.70</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Snorkeling at Crystal Bay</div>
                        <div class="activity-description">Clear waters and colorful marine life <span class="price">$17</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Warung Sewa Dinner</div>
                        <div class="activity-description">Local Indonesian cuisine <span class="price">$7</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header">Day 10: Nusa Penida to Ubud (July 26)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Return to Ubud</div>
                        <div class="activity-description">Check into Sri Ratih Cottages <span class="price">$60/night</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Goa Gajah (Elephant Cave)</div>
                        <div class="activity-description">Ancient Hindu temple complex <span class="price">$1</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Hujan Locale</div>
                        <div class="activity-description">Modern Indonesian cuisine <span class="price">$17</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header">Day 11: Ubud (July 27)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Full Day</div>
                        <div class="activity-title">Mount Batur Sunrise Trek</div>
                        <div class="activity-description">Active volcano hike with breakfast at summit <span class="price">$34</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Mozaic Restaurant</div>
                        <div class="activity-description">French-Indonesian fusion fine dining <span class="price">$67</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header">Day 12: Ubud (July 28)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Tirta Empul Temple</div>
                        <div class="activity-description">Holy spring water temple for purification <span class="price">$3.50</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Bali Bird Park</div>
                        <div class="activity-description">Tropical birds in natural habitats <span class="price">$26</span></div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Ibu Rai Bar & Restaurant</div>
                        <div class="activity-description">Local favorite with live music <span class="price">$14</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 13: Ubud to Seminyak (July 29) - Work Day</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Work Session</div>
                        <div class="activity-description">Final work session of the trip</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Shopping & Exploration</div>
                        <div class="activity-description">Last-minute souvenir shopping</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Evening</div>
                        <div class="activity-title">Kynd Community</div>
                        <div class="activity-description">Healthy plant-based cuisine <span class="price">$10</span></div>
                    </div>
                </div>
            </div>

            <div class="day-card">
                <div class="day-header work-day">Day 14: Departure (July 30)</div>
                <div class="day-content">
                    <div class="activity">
                        <div class="activity-time">Morning</div>
                        <div class="activity-title">Hotel Relaxation</div>
                        <div class="activity-description">Final moments to soak in the Bali vibes</div>
                    </div>
                    <div class="activity">
                        <div class="activity-time">Afternoon</div>
                        <div class="activity-title">Airport Transfer</div>
                        <div class="activity-description">Journey to Ngurah Rai International Airport for departure</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="budget-section">
            <h2 class="budget-title">Budget Breakdown</h2>
            <div class="budget-grid">
                <div class="budget-item">
                    <div class="budget-category">Accommodation</div>
                    <div class="budget-amount">$840</div>
                </div>
                <div class="budget-item">
                    <div class="budget-category">Food & Dining</div>
                    <div class="budget-amount">$140</div>
                </div>
                <div class="budget-item">
                    <div class="budget-category">Transportation</div>
                    <div class="budget-amount">$80</div>
                </div>
                <div class="budget-item">
                    <div class="budget-category">Activities</div>
                    <div class="budget-amount">$87</div>
                </div>
                <div class="budget-item" style="border-left-color: #059669; background: #ecfdf5;">
                    <div class="budget-category">Total Estimated</div>
                    <div class="budget-amount">$1,147</div>
                </div>
            </div>
        </section>

        <section class="tips-section">
            <h3 class="tips-title">Local Tips & Recommendations</h3>
            <ul class="tips-list">
                <li>Dress modestly when visiting temples - cover shoulders and knees</li>
                <li>July is dry season, but pack a light rain jacket for unexpected showers</li>
                <li>Download Grab app for easy and affordable transportation</li>
                <li>Always carry sunscreen and a reusable water bottle</li>
                <li>Respect local customs and always ask before photographing people</li>
                <li>Book popular restaurants like Locavore and Mozaic well in advance</li>
            </ul>
        </section>
    </div>

    <script>
        function formatDateForICS(dateStr, time = "09:00") {
            // Parse the date and add the time
            const date = new Date(dateStr + "T" + time + ":00");
            return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
        }

        function generateUID() {
            return 'event-' + Math.random().toString(36).substr(2, 9) + '@travel-planner.com';
        }

        function createICSEvent(summary, description, location, startDate, endDate) {
            return [
                'BEGIN:VEVENT',
                `UID:${generateUID()}`,
                `DTSTART:${startDate}`,
                `DTEND:${endDate}`,
                `SUMMARY:${summary}`,
                `DESCRIPTION:${description}`,
                location ? `LOCATION:${location}` : '',
                'STATUS:CONFIRMED',
                'SEQUENCE:0',
                'END:VEVENT'
            ].filter(line => line !== '').join('\r\n');
        }

        function exportToCalendar() {
            const itineraryData = [
                {
                    date: "2025-07-17",
                    title: "Day 1: Arrival in Bali",
                    activities: [
                        { time: "14:00", duration: 2, title: "Transfer to Ubud", description: "Check into Alaya Ubud", location: "Ubud, Bali" },
                        { time: "19:00", duration: 2, title: "Explore Ubud Market", description: "Dinner at Warung Babi Guling Ibu Oka", location: "Ubud Market, Bali" }
                    ]
                },
                {
                    date: "2025-07-18",
                    title: "Day 2: Ubud - Work Day",
                    activities: [
                        { time: "06:00", duration: 6, title: "Work Session", description: "Work from 6 AM to 12 PM - productive morning at the hotel", location: "Alaya Ubud" },
                        { time: "14:00", duration: 3, title: "Tegallalang Rice Terraces", description: "Beautiful terraced landscapes perfect for photos", location: "Tegallalang Rice Terraces, Ubud" },
                        { time: "19:00", duration: 2, title: "Dinner at Naughty Nuri's", description: "Famous for their ribs and lively atmosphere", location: "Naughty Nuri's, Ubud" }
                    ]
                },
                {
                    date: "2025-07-19",
                    title: "Day 3: Ubud",
                    activities: [
                        { time: "08:00", duration: 1.5, title: "Yoga at Radiantly Alive", description: "Start your day with peaceful yoga practice", location: "Radiantly Alive, Ubud" },
                        { time: "14:00", duration: 2, title: "Ubud Monkey Forest", description: "Meet the local macaques in their natural habitat", location: "Ubud Monkey Forest" },
                        { time: "19:00", duration: 3, title: "Fine dining at Locavore", description: "Award-winning restaurant (book in advance!)", location: "Locavore, Ubud" }
                    ]
                },
                {
                    date: "2025-07-20",
                    title: "Day 4: Ubud to Seminyak",
                    activities: [
                        { time: "10:00", duration: 2, title: "Check out & Transfer", description: "Journey to Seminyak (1-hour drive)", location: "Ubud to Seminyak" },
                        { time: "15:00", duration: 3, title: "Check into The Haven Suites", description: "Relax at Berawa Beach", location: "The Haven Suites, Seminyak" },
                        { time: "18:00", duration: 2, title: "Sunset dinner at La Plancha", description: "Beachfront dining with colorful bean bags", location: "La Plancha, Seminyak" }
                    ]
                },
                {
                    date: "2025-07-21",
                    title: "Day 5: Seminyak - Work Day",
                    activities: [
                        { time: "06:00", duration: 6, title: "Work Session", description: "Work from 6 AM to 12 PM with ocean breeze", location: "The Haven Suites" },
                        { time: "14:00", duration: 2, title: "Petitenget Temple", description: "Sacred Balinese temple by the sea", location: "Petitenget Temple, Seminyak" },
                        { time: "19:00", duration: 2, title: "Dinner at Bambu", description: "Indonesian fine dining experience", location: "Bambu, Seminyak" }
                    ]
                },
                {
                    date: "2025-07-22",
                    title: "Day 6: Seminyak - Work Day",
                    activities: [
                        { time: "06:00", duration: 6, title: "Work Session", description: "Productive morning work session", location: "The Haven Suites" },
                        { time: "14:00", duration: 3, title: "Kuta Beach Relaxation", description: "Famous surf beach with golden sand", location: "Kuta Beach" },
                        { time: "19:00", duration: 2, title: "Sea Circus Dinner", description: "Trendy spot with great cocktails", location: "Sea Circus, Seminyak" }
                    ]
                },
                {
                    date: "2025-07-23",
                    title: "Day 7: Seminyak - Work Day",
                    activities: [
                        { time: "06:00", duration: 6, title: "Work Session", description: "Final morning work session in Seminyak", location: "The Haven Suites" },
                        { time: "14:00", duration: 3, title: "Spa Day at Jari Menari", description: "Couple's traditional Balinese massage", location: "Jari Menari Spa, Seminyak" },
                        { time: "19:00", duration: 2, title: "Sisterfields Dinner", description: "Popular cafe with healthy options", location: "Sisterfields, Seminyak" }
                    ]
                },
                {
                    date: "2025-07-24",
                    title: "Day 8: Seminyak to Nusa Penida - Work Day",
                    activities: [
                        { time: "06:00", duration: 6, title: "Work Session", description: "Early work before island adventure", location: "The Haven Suites" },
                        { time: "14:00", duration: 4, title: "Fast Boat to Nusa Penida", description: "Check into Semabu Hills Hotel", location: "Nusa Penida" },
                        { time: "19:00", duration: 2, title: "Hotel Dinner", description: "Relax after travel day", location: "Semabu Hills Hotel" }
                    ]
                },
                {
                    date: "2025-07-25",
                    title: "Day 9: Nusa Penida",
                    activities: [
                        { time: "08:00", duration: 4, title: "Kelingking Beach & Angel's Billabong", description: "Iconic clifftop views and natural infinity pool", location: "Kelingking Beach, Nusa Penida" },
                        { time: "13:00", duration: 3, title: "Snorkeling at Crystal Bay", description: "Clear waters and colorful marine life", location: "Crystal Bay, Nusa Penida" },
                        { time: "19:00", duration: 2, title: "Warung Sewa Dinner", description: "Local Indonesian cuisine", location: "Warung Sewa, Nusa Penida" }
                    ]
                },
                {
                    date: "2025-07-26",
                    title: "Day 10: Nusa Penida to Ubud",
                    activities: [
                        { time: "09:00", duration: 3, title: "Return to Ubud", description: "Check into Sri Ratih Cottages", location: "Ubud" },
                        { time: "14:00", duration: 2, title: "Goa Gajah (Elephant Cave)", description: "Ancient Hindu temple complex", location: "Goa Gajah, Ubud" },
                        { time: "19:00", duration: 2, title: "Hujan Locale", description: "Modern Indonesian cuisine", location: "Hujan Locale, Ubud" }
                    ]
                },
                {
                    date: "2025-07-27",
                    title: "Day 11: Ubud",
                    activities: [
                        { time: "02:00", duration: 10, title: "Mount Batur Sunrise Trek", description: "Active volcano hike with breakfast at summit", location: "Mount Batur, Bali" },
                        { time: "19:00", duration: 3, title: "Mozaic Restaurant", description: "French-Indonesian fusion fine dining", location: "Mozaic, Ubud" }
                    ]
                },
                {
                    date: "2025-07-28",
                    title: "Day 12: Ubud",
                    activities: [
                        { time: "09:00", duration: 2, title: "Tirta Empul Temple", description: "Holy spring water temple for purification", location: "Tirta Empul Temple, Ubud" },
                        { time: "14:00", duration: 3, title: "Bali Bird Park", description: "Tropical birds in natural habitats", location: "Bali Bird Park" },
                        { time: "19:00", duration: 2, title: "Ibu Rai Bar & Restaurant", description: "Local favorite with live music", location: "Ibu Rai, Ubud" }
                    ]
                },
                {
                    date: "2025-07-29",
                    title: "Day 13: Ubud to Seminyak - Work Day",
                    activities: [
                        { time: "06:00", duration: 6, title: "Work Session", description: "Final work session of the trip", location: "Sri Ratih Cottages" },
                        { time: "14:00", duration: 3, title: "Shopping & Exploration", description: "Last-minute souvenir shopping", location: "Seminyak" },
                        { time: "19:00", duration: 2, title: "Kynd Community", description: "Healthy plant-based cuisine", location: "Kynd Community, Seminyak" }
                    ]
                },
                {
                    date: "2025-07-30",
                    title: "Day 14: Departure",
                    activities: [
                        { time: "10:00", duration: 2, title: "Hotel Relaxation", description: "Final moments to soak in the Bali vibes", location: "Hotel" },
                        { time: "14:00", duration: 3, title: "Airport Transfer", description: "Journey to Ngurah Rai International Airport for departure", location: "Ngurah Rai Airport" }
                    ]
                }
            ];

            let icsContent = [
                'BEGIN:VCALENDAR',
                'VERSION:2.0',
                'PRODID:-//Travel Planner//Bali Itinerary//EN',
                'CALSCALE:GREGORIAN',
                'METHOD:PUBLISH'
            ].join('\r\n');

            itineraryData.forEach(day => {
                day.activities.forEach(activity => {
                    const startTime = activity.time;
                    const startHour = parseInt(startTime.split(':')[0]);
                    const startMinute = parseInt(startTime.split(':')[1]);
                    const endHour = startHour + Math.floor(activity.duration);
                    const endMinute = startMinute + ((activity.duration % 1) * 60);

                    const endTimeStr = `${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`;

                    const startDate = formatDateForICS(day.date, startTime);
                    const endDate = formatDateForICS(day.date, endTimeStr);

                    const event = createICSEvent(
                        activity.title,
                        activity.description,
                        activity.location,
                        startDate,
                        endDate
                    );

                    icsContent += '\r\n' + event;
                });
            });

            icsContent += '\r\nEND:VCALENDAR';

            // Create and download the file
            const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.download = 'bali-travel-itinerary.ics';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html> 